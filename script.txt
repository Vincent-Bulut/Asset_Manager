
from flask import Flask, jsonify, request
from models import Session, BusinessManager

app = Flask(__name__)

@app.route('/business_manager/<ut>', methods=['GET'])
def get_business_manager(ut):
    session = Session()  # Assumons que Session est configurÃ© correctement pour SQLAlchemy
    business_manager = session.query(BusinessManager).filter_by(ut=ut).first()
    if business_manager is not None:
        assistants_data = [
            {"ut": assistant.ut, "ut_bm": assistant.ut_bm}
            for assistant in business_manager.assistants
        ]
        return jsonify({
            "ut": business_manager.ut,
            "assistants": assistants_data
        })
    else:
        return jsonify({"error": "BusinessManager not found"}), 404

if __name__ == '__main__':
    app.run(debug=True)