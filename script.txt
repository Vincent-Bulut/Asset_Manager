
import pandas as pd
import re

class DataFrameProcessor:
    def __init__(self, df):
        self.df = df  # Le dataframe est un membre de la classe

    def convert_label_to_years(self, column_name):
        # Fonction interne pour convertir les labels
        def convert_label(label):
            match = re.search(r'(\d+)\s*(M|Y)', label)
            if match:
                value, unit = match.groups()
                value = int(value)
                if unit == 'M':  # Convertir les mois en années
                    return value / 12
                elif unit == 'Y':  # Garder les années telles quelles
                    return value
            return None  # Si aucun match n'est trouvé

        # Appliquer la fonction sur la colonne spécifiée du dataframe
        self.df['converted_years'] = self.df[column_name].apply(convert_label)
    
    def display(self):
        # Fonction pour afficher le dataframe
        print(self.df)

# Exemple d'utilisation
data = {'labels': ['xxxx M1', 'xxxx Y10', 'xxxx M12', 'xxxx Y5', 'sample M6', 'example Y20']}
df = pd.DataFrame(data)

# Créer une instance de la classe avec le dataframe
processor = DataFrameProcessor(df)

# Appliquer la conversion sur la colonne 'labels'
processor.convert_label_to_years('labels')

# Afficher les résultats
processor.display()