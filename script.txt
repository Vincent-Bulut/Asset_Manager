
Sub ExportListObjectToTextFile()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim cell As Range
    Dim filePath As String
    Dim fileNum As Integer
    Dim i As Long, j As Long

    ' Définir la feuille de calcul et le ListObject
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Changez le nom de la feuille selon vos besoins
    Set tbl = ws.ListObjects("Table1") ' Changez le nom de la table selon vos besoins

    ' Définir le chemin du fichier
    filePath = ThisWorkbook.Path & "\exported_table.txt"
    
    ' Ouvrir le fichier en écriture
    fileNum = FreeFile
    Open filePath For Output As #fileNum
    
    ' Ecrire les en-têtes
    For j = 1 To tbl.HeaderRowRange.Columns.Count
        If j = tbl.HeaderRowRange.Columns.Count Then
            Print #fileNum, tbl.HeaderRowRange.Cells(1, j).Value
        Else
            Print #fileNum, tbl.HeaderRowRange.Cells(1, j).Value & vbTab;
        End If
    Next j
    
    ' Ecrire les données
    For i = 1 To tbl.ListRows.Count
        For j = 1 To tbl.ListColumns.Count
            If j = tbl.ListColumns.Count Then
                Print #fileNum, tbl.DataBodyRange.Cells(i, j).Value
            Else
                Print #fileNum, tbl.DataBodyRange.Cells(i, j).Value & vbTab;
            End If
        Next j
    Next i

    ' Fermer le fichier
    Close #fileNum
    
    MsgBox "Export completed successfully!", vbInformation
End Sub