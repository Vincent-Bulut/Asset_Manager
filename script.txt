
// Create an array to hold all the promises
let promises = [];

for (let cle in dico_update_queue) {
  // Create the request body outside the loop
  const requestBody = {
    id_trader: cle.split("_")[0],
    id_structure: cle.split("_")[1],
    id_montant: cle.split("_")[2],
    time_value: dico_update_queue[cle],
  };

  // Create a function to make API call
  let makeApiCall = (cle, requestBody) => {
    return instance.put(`trader/${cle.split("_")[3]}/time`, JSON.stringify(requestBody));
  };

  // Add the promise from the API call to the array
  promises.push(makeApiCall(cle, requestBody));
}

// Use Promise.all to execute all the promises
Promise.all(promises)
  .then(responses => {
    // Handle responses here
    responses.forEach(response => {
      console.log('success:', response);
      // Further processing of each response if necessary
    });
  })
  .catch(error => {
    // Handle errors here
    console.error('API call error:', error);
  });