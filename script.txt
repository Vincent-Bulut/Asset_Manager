
from datetime import datetime
from sqlalchemy import and_

# Obtenir la date actuelle
current_date = datetime.now()

# Calculer le premier mois et l'année pour la requête
if current_date.month - 3 <= 0:
    query_year = current_date.year - 1
    query_month = 12 + (current_date.month - 3)
else:
    query_year = current_date.year
    query_month = current_date.month - 3

# Faire la requête avec SQLAlchemy
# Vous devez remplacer `session` par votre objet de session SQLAlchemy actuel
results = session.query(TraderTimes).filter(
    and_(
        TraderTimes.time_year >= query_year,
        TraderTimes.time_month >= query_month)
).all()

# Extraire les valeurs time_value
time_values = [result.time_value for result in results]

  