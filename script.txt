
import pandas as pd
import numpy as np

# Création d'un exemple de DataFrame avec 900 colonnes
data = np.random.rand(10, 900)  # 10 lignes et 900 colonnes avec des valeurs aléatoires
df = pd.DataFrame(data, columns=[f"col_{i}" for i in range(900)])

# Étape 1 : Extraire les colonnes 99 à 200 sous forme de tableau NumPy
cols_to_transform = df.iloc[:, 99:201].values

# Étape 2 : Appliquer la transformation cumulative en NumPy
for i in range(1, cols_to_transform.shape[1]):
    cols_to_transform[:, i] = cols_to_transform[:, i] - cols_to_transform[:, i-1]

# Étape 3 : Réinjecter les résultats dans le DataFrame
df.iloc[:, 100:201] = cols_to_transform[:, 1:]

# Vérification : Afficher les colonnes 99 à 201 pour voir la transformation
print(df.iloc[:, 99:201])