
from sqlalchemy.orm import sessionmaker
from sqlalchemy import create_engine, select
from sqlalchemy.orm import aliased

# Remplacer par l'URL de connexion appropriée pour votre base de données
DATABASE_URL = "postgresql://user:password@host/database"
engine = create_engine(DATABASE_URL)

Session = sessionmaker(bind=engine)
session = Session()

# Assurez-vous de remplacer ces imports par vos classes réelles
from your_models import Users, BusinessManager, Traders

# Aliasing des tables
u = aliased(Users)
bm = aliased(BusinessManager)
t = aliased(Traders)

# Construction de la requête
stmt = (
    select(u, bm, t)
    .outerjoin(bm, u.ut == bm.ut)
    .outerjoin(t, u.ut == t.ut)
    .where(u.ut == 'ut3k8g')
)

# Exécution de la requête
results = session.execute(stmt).all()

# Affichage des résultats
for row in results:
    print(row)