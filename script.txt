
import pandas as pd

class MaquetteMngr:
    """Use for build the final maquette"""

    def __init__(self, pivot_itac_c, pivot_steve_model, pivot_steve_cont, pivot_steve_cont_np):
        self._pivot_itac_c = pivot_itac_c
        self._pivot_steve_model = pivot_steve_model
        self._pivot_steve_cont = pivot_steve_cont
        self._pivot_steve_cont_np = pivot_steve_cont_np
        self.maquette_all = pd.DataFrame()

    def create_key_column(self, df):
        """Creates a key column by concatenating the first 14 columns of the DataFrame."""
        if df.shape[1] < 14:
            raise ValueError("The DataFrame does not have 14 columns.")
        
        df['key'] = df.iloc[:, :14].apply(lambda row: '_'.join(row.values.astype(str)), axis=1)
        return df

    def process_all_dataframes(self):
        """Process all dataframes to add the key column."""
        self._pivot_itac_c = self.create_key_column(self._pivot_itac_c)
        self._pivot_steve_model = self.create_key_column(self._pivot_steve_model)
        self._pivot_steve_cont = self.create_key_column(self._pivot_steve_cont)
        self._pivot_steve_cont_np = self.create_key_column(self._pivot_steve_cont_np)

# Exemple d'utilisation
# Assurez-vous que les DataFrames pivot_itac_c, pivot_steve_model, pivot_steve_cont et pivot_steve_cont_np existent
pivot_itac_c = pd.DataFrame([[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15], [16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]], columns=[f'col{i}' for i in range(1, 16)])
pivot_steve_model = pivot_itac_c.copy()
pivot_steve_cont = pivot_itac_c.copy()
pivot_steve_cont_np = pivot_itac_c.copy()

manager = MaquetteMngr(pivot_itac_c, pivot_steve_model, pivot_steve_cont, pivot_steve_cont_np)
manager.process_all_dataframes()

print("Pivot ITAC C with key:")
print(manager._pivot_itac_c)

print("\nPivot Steve Model with key:")
print(manager._pivot_steve_model)

print("\nPivot Steve Cont with key:")
print(manager._pivot_steve_cont)

print("\nPivot Steve Cont NP with key:")
print(manager._pivot_steve_cont_np)