
import pandas as pd
import numpy as np

# Supposons que 'df' soit ton DataFrame avec 900 colonnes

# Extraire les colonnes de 100 à 150
df_sub = df.iloc[:, 100:151]

# Fonction pour trouver la dernière valeur non nulle et son indice
def last_non_null_index(row):
    # Parcours des colonnes de droite à gauche (de la colonne 150 à 100)
    for col in reversed(df_sub.columns):
        if pd.notnull(row[col]):
            return col  # Retourne l'indice de la colonne
    return np.nan  # Si toutes les valeurs sont nulles, retourne NaN

# Appliquer cette fonction à chaque ligne du DataFrame
df['last_non_null_col'] = df_sub.apply(last_non_null_index, axis=1)

# La nouvelle colonne 'last_non_null_col' contiendra l'indice de la colonne de la dernière valeur non nulle