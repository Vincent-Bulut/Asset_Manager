
Sub CompactAndRepairAccessDB()
    Dim accessApp As Object
    Set accessApp = CreateObject("Access.Application")
    
    ' Chemin complet vers la base de données Access à compacter et réparer
    Dim sourceDB As String
    sourceDB = "C:\Chemin\vers\la\base\de\donnees.accdb"
    
    ' Chemin complet où enregistrer la base de données compactée
    Dim destDB As String
    destDB = "C:\Chemin\vers\la\base\de\donnees_compactee.accdb"

    ' Exécuter la compactation et la réparation
    accessApp.DBEngine.CompactDatabase sourceDB, destDB
    
    ' Fermer l'application Access
    accessApp.Quit
    
    ' Libérer l'objet
    Set accessApp = Nothing

    ' Remplacer l'ancienne base de données par la nouvelle
    ' Attention : Ces opérations peuvent être dangereuses si vous n'avez pas de sauvegarde
    Kill sourceDB
    Name destDB As sourceDB
End Sub