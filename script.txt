from sqlalchemy.orm import sessionmaker
from your_module import base  # Assurez-vous d'importer les classes de base de SQLAlchemy
from your_module import Entity, Traders, TraderAllocation, TraderTimes, Structure  # Importez vos classes de modèle

# Créer une session avec la base de données
Session = sessionmaker(bind=your_engine)
session = Session()

# Remplacer 'some_ut' par le 'ut' réel du trader que vous recherchez
trader_ut = 'some_ut'

# Construction de la requête
result = session.query(
    Traders,
    Entity,
    TraderAllocation,
    TraderTimes,
    Structure
).join(
    Entity, Entity.entity_code == Traders.entity_code
).join(
    TraderAllocation, TraderAllocation.id_trader == Traders.id_trader
).join(
    TraderTimes, TraderTimes.id_trader == Traders.id_trader
).join(
    Structure, Structure.id_structure == TraderAllocation.id_structure
).filter(
    Traders.ut == trader_ut
).all()

# Fermer la session
session.close()

# Traiter le résultat
for item in result:
    trader, entity, trader_allocation, trader_times, structure = item
    # Ici vous pouvez accéder aux attributs de chaque objet
    # Exemple: trader.name, entity.country, etc.