
# Connexion à la base de données
engine = create_engine('your_database_url')
Base.metadata.create_all(engine)
session = Session(engine)

# ID du trader que vous voulez rechercher
trader_id = 1

# Requête pour obtenir les structures pour un trader donné
stmt = (
    select(Structure)
    .join(TraderAllocation, Structure.id_structure == TraderAllocation.id_struct)
    .join(Traders, Traders.id_trader == TraderAllocation.id_trd)
    .where(Traders.id_trader == trader_id)
)

# Exécuter la requête
result = session.execute(stmt).fetchall()

# Formater les données
formatted_data = [
    {
        "Structure ID": row.Structure.id_structure,
        "CDR": row.Structure.cdr,
        "PS Type": row.Structure.ps_type,
        "CDR Name": row.Structure.cdr_name,
        "PS Name": row.Structure.ps_name,
    }
    for row in result
]

# Afficher les données formatées
import pprint
pprint.pprint(formatted_data)