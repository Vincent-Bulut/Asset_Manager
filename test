
import pandas as pd

# Exemple de DataFrame
data = {
    'groupe': ['A', 'A', 'A', 'B', 'B', 'B'],
    'montant': [100, 200, 150, 300, 400, 300],
    'col1': [10, 20, 30, 40, 50, 60],
    'col2': [5, 15, 25, 35, 45, 55]
}

df = pd.DataFrame(data)

# 1. Trouver le montant maximal par groupe
max_montant = df.groupby('groupe')['montant'].transform('max')

# 2. Filtrer les lignes où le montant est égal au montant maximal du groupe
df_max = df[df['montant'] == max_montant]

# 3. Effectuer des manipulations sur les lignes filtrées
# Exemple de manipulation : multiplier les colonnes numériques par 2
df_max[['col1', 'col2']] = df_max[['col1', 'col2']] * 2

# Affichage du DataFrame modifié
print(df_max)