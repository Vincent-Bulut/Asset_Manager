
import pandas as pd

# Exemple de DataFrame
data = {
    'groupe': ['A', 'A', 'A', 'B', 'B', 'B'],
    'montant': [-100, 200, -150, 300, -250, 300]
}

df = pd.DataFrame(data)

# Calcul du montant maximum en valeur absolue par groupe
df['max_montant_abs'] = df.groupby('groupe')['montant'].transform(lambda x: x.abs().max())

# Affichage du DataFrame
print(df)