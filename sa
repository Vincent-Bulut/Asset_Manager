
Voici le code modifié pour ajouter des boutons ”+” et ”-” permettant de dépiler (masquer) et empiler (afficher) les sections. Je vais inclure ces boutons en haut de chaque section avec la logique JavaScript pour gérer l’affichage/masquage.

Code Modifié

<script>
    // Function to initialize buttons on targeted divs
    function initializeCloneAndRemoveButtons(selector) {
        const targetDivs = document.querySelectorAll(selector);

        targetDivs.forEach((div) => {
            // Add the clone button if it doesn't already exist
            if (!div.querySelector('.clone-btn')) {
                const cloneButton = document.createElement('button');
                cloneButton.innerHTML = '<i class="fas fa-plus"></i>'; // "+" icon
                cloneButton.className = 'clone-btn';
                cloneButton.addEventListener('click', () => cloneSection(div));
                div.prepend(cloneButton);
            }

            // Add the toggle (expand/collapse) button
            if (!div.querySelector('.toggle-btn')) {
                const toggleButton = document.createElement('button');
                toggleButton.innerHTML = '<i class="fas fa-minus"></i>'; // "-" icon for collapse
                toggleButton.className = 'toggle-btn';
                toggleButton.addEventListener('click', () => toggleSection(div, toggleButton));
                div.prepend(toggleButton);
            }
        });
    }

    // Function to clone a section and add a remove button to the cloned section
    function cloneSection(section) {
        const clone = section.cloneNode(true);

        // Remove any existing clone button in the cloned section
        const existingCloneButton = clone.querySelector('.clone-btn');
        if (existingCloneButton) {
            existingCloneButton.remove();
        }

        // Add a remove button to the cloned section
        if (!clone.querySelector('.remove-btn')) {
            const removeButton = document.createElement('button');
            removeButton.innerHTML = '<i class="fas fa-trash"></i>'; // "Trash" icon
            removeButton.className = 'remove-btn';
            removeButton.addEventListener('click', () => clone.remove());
            clone.prepend(removeButton);
        }

        // Add a toggle button for the cloned section
        if (!clone.querySelector('.toggle-btn')) {
            const toggleButton = document.createElement('button');
            toggleButton.innerHTML = '<i class="fas fa-minus"></i>'; // "-" icon for collapse
            toggleButton.className = 'toggle-btn';
            toggleButton.addEventListener('click', () => toggleSection(clone, toggleButton));
            clone.prepend(toggleButton);
        }

        // Insert the cloned section after the original section
        section.parentNode.insertBefore(clone, section.nextSibling);
    }

    // Function to toggle (collapse/expand) the section
    function toggleSection(section, toggleButton) {
        const content = Array.from(section.children).slice(2); // Skip buttons
        content.forEach((child) => {
            if (child.style.display === 'none') {
                child.style.display = '';
                toggleButton.innerHTML = '<i class="fas fa-minus"></i>'; // Change to collapse icon
            } else {
                child.style.display = 'none';
                toggleButton.innerHTML = '<i class="fas fa-plus"></i>'; // Change to expand icon
            }
        });
    }

    // Initialize the buttons on all divs with the class "repeatable"
    initializeCloneAndRemoveButtons('.repeatable');
</script>

Ajout d’icônes Font Awesome

Ajoutez cette ligne dans le <head> pour utiliser les icônes Font Awesome (pour les boutons +, - et poubelle) :

<head>
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
</head>

Explications des Fonctionnalités Ajoutées
	1.	Bouton de bascule (afficher/masquer) :
	•	Le bouton “-” (icône de réduction) masque les contenus en dehors des boutons.
	•	Une fois masqué, l’icône devient “+” pour afficher les contenus.
	2.	Fonction toggleSection :
	•	Elle parcourt les enfants de la section, en ignorant les boutons, pour afficher ou masquer les contenus.
	3.	Bouton de suppression :
	•	Ajouté aux sections clonées uniquement, avec une icône “poubelle” pour supprimer la section.

CSS Suggestion

Ajoutez du CSS pour améliorer le positionnement et le style des boutons :

button {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.2em;
    margin-right: 5px;
}

button i {
    color: #007bff; /* Couleur des icônes */
}

button i:hover {
    color: #0056b3; /* Couleur au survol */
}

.repeatable {
    position: relative;
    border: 1px solid #ccc;
    padding: 10px;
    margin-bottom: 10px;
}

.clone-btn,
.remove-btn,
.toggle-btn {
    display: inline-block;
    margin-right: 5px;
    vertical-align: middle;
}

Résultat Attendu
	1.	Chaque section affiche un bouton + pour cloner, - pour basculer l’affichage et, pour les copies, un bouton poubelle pour supprimer.
	2.	Le bouton “-” masque le contenu de la section et devient “+” pour l’afficher à nouveau.
	3.	Les boutons sont positionnés en haut de chaque section.

Si quelque chose ne fonctionne pas comme prévu ou si vous souhaitez encore des ajustements, n’hésitez pas à me le dire !