
# On suppose que le DataFrame s'appelle 'df'

# Récupérer les colonnes de 100 à 200 (les indices des colonnes commencent à 0 donc colonne 100 correspond à df.iloc[:, 100])
df_selected = df.iloc[:, 100:201]  # On prend les colonnes 100 à 200 inclus

# Créer une copie pour ne pas affecter les valeurs lors du calcul
df_transformed = df_selected.copy()

# Appliquer les différences entre colonnes consécutives
for i in range(1, df_transformed.shape[1]):  # Commence à la 2ème colonne (index 1)
    df_transformed.iloc[:, i] = df_selected.iloc[:, i - 1] - df_selected.iloc[:, i]

# Réinjecter les colonnes modifiées dans le DataFrame original
df.iloc[:, 101:201] = df_transformed.iloc[:, 1:]  # On saute la première colonne (100) car elle reste inchangée

# df contient maintenant les colonnes modifiées